infile="E:/Dropbox/Lab/Lab_Documents/TCGA/TCGA-55-6982_LUAD_n_48_squire_countgtf_closest_TE.txt"
countgtf <- read.delim(infile, header=FALSE, stringsAsFactors=FALSE)
head(infile)
head(countgtf)
intergenic_100k_0flank_100_sample_01_1_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/intergenic_100k_0flank_100_sample_01_1_counts.txt", stringsAsFactors=FALSE)
View(intergenic_100k_0flank_100_sample_01_1_counts)
intergenic_100k_0flank_100_sample_01_1_TEcount <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/intergenic_100k_0flank_100_sample_01_1_TEcount.txt", header=FALSE, stringsAsFactors=FALSE)
View(intergenic_100k_0flank_100_sample_01_1_TEcount)
colnames(intergenic_100k_0flank_100_sample_01_1_TEcount ) <-c("TE_ID","counts")
intergenic_100k_0flank_100_sample_01_1_counts$coord<-get_coord(intergenic_100k_0flank_100_sample_01_1_counts)
get_coord <- function(df) {
df_TE_ID<- strsplit(df$TE_ID,"\\|")
chr <-sapply(df_TE_ID,"[[",1)
start <-sapply(df_TE_ID,"[[",2)
end <-sapply(df_TE_ID,"[[",3)
coord<- paste(chr,start, end, subfamily, sep="|")
return(coord)
}
intergenic_100k_0flank_100_sample_01_1_counts$coord<-get_coord(intergenic_100k_0flank_100_sample_01_1_counts)
get_coord <- function(df) {
df_TE_ID<- strsplit(df$TE_ID,"\\|")
chr <-sapply(df_TE_ID,"[[",1)
start <-sapply(df_TE_ID,"[[",2)
end <-sapply(df_TE_ID,"[[",3)
coord<- paste(chr,start, end, sep="|")
return(coord)
}
intergenic_100k_0flank_100_sample_01_1_counts$coord<-get_coord(intergenic_100k_0flank_100_sample_01_1_counts)
intergenic_100k_0flank_100_sample_01_1_TEcount$coord<-get_coord(intergenic_100k_0flank_100_sample_01_1_TEcount)
count_orig<-merge(intergenic_100k_0flank_100_sample_01_1_TEcount,intergenic_100k_0flank_100_sample_01_1_counts,by="coord",all=TRUE)
head(count_orig)
count_orig<-merge(intergenic_100k_0flank_100_sample_01_1_TEcount,intergenic_100k_0flank_100_sample_01_1_counts,by="coord")
count_orig<-merge(intergenic_100k_0flank_100_sample_01_1_TEcount,intergenic_100k_0flank_100_sample_01_1_counts,by="coord",all=TRUE)
L1HS<-count_orig[grepl("L1HS",count_orig$TE_ID),]
head(L1HS)
get_coord <- function(TE_ID) {
df_TE_ID<- strsplit(TE_ID,"\\|")
chr <-sapply(df_TE_ID,"[[",1)
start <-sapply(df_TE_ID,"[[",2)
end <-sapply(df_TE_ID,"[[",3)
coord<- paste(chr,start, end, sep="|")
return(coord)
}
colnames(intergenic_100k_0flank_100_sample_01_1_TEcount ) <-c("TE_ID_old","counts")
get_coord <- function(TE_ID) {
df_TE_ID<- strsplit(TE_ID,"\\|")
chr <-sapply(df_TE_ID,"[[",1)
start <-sapply(df_TE_ID,"[[",2)
end <-sapply(df_TE_ID,"[[",3)
coord<- paste(chr,start, end, sep="|")
return(coord)
}
count_orig<-merge(intergenic_100k_0flank_100_sample_01_1_TEcount,intergenic_100k_0flank_100_sample_01_1_counts,by="coord",all=TRUE)
intergenic_100k_0flank_100_sample_01_1_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/intergenic_100k_0flank_100_sample_01_1_counts.txt", stringsAsFactors=FALSE)
intergenic_100k_0flank_100_sample_01_1_TEcount <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/intergenic_100k_0flank_100_sample_01_1_TEcount.txt", header=FALSE, stringsAsFactors=FALSE)
colnames(intergenic_100k_0flank_100_sample_01_1_TEcount ) <-c("TE_ID_old","counts")
get_coord <- function(TE_ID) {
df_TE_ID<- strsplit(TE_ID,"\\|")
chr <-sapply(df_TE_ID,"[[",1)
start <-sapply(df_TE_ID,"[[",2)
end <-sapply(df_TE_ID,"[[",3)
coord<- paste(chr,start, end, sep="|")
return(coord)
}
intergenic_100k_0flank_100_sample_01_1_counts$coord<-get_coord(intergenic_100k_0flank_100_sample_01_1_counts$TE_ID)
intergenic_100k_0flank_100_sample_01_1_TEcount$coord<-get_coord(intergenic_100k_0flank_100_sample_01_1_TEcount$TE_ID_old)
count_orig<-merge(intergenic_100k_0flank_100_sample_01_1_TEcount,intergenic_100k_0flank_100_sample_01_1_counts,by="coord",all=TRUE)
L1HS<-count_orig[grepl("L1HS",count_orig$TE_ID),]
head(L1HS)
count_orig[is.na(count_orig)]<-0
L1HS<-count_orig[grepl("L1HS",count_orig$TE_ID),]
ggplot(L1HS,aes(x=avg_conf,y=tot_counts/counts))+geom_point()
library(ggplot2)
library(plyr)
ggplot(L1HS,aes(x=avg_conf,y=tot_counts/counts))+geom_point()
ggplot(L1HS,aes(x=counts,y=tot_counts))+geom_point()
L1HS$accuracy<-L1HS$tot_counts/counts
L1HS$accuracy<-L1HS$tot_counts/L1HS$counts
hist(L1HS[L1HS$accuracy>0]$avg_conf)
hist(L1HS[L1HS$accuracy>0,]$avg_conf)
hist(L1HS[L1HS$accuracy>0 & L1HS$accuracy < inf,]$avg_conf)
range(L1HS$accuracy)
hist(L1HS[L1HS$accuracy>0 & L1HS$accuracy < Inf,]$avg_conf)
Inf,]$avg_conf)
hist(L1HS[L1HS$accuracy==Inf,]$avg_conf)
nrow(L1HS[L1HS$accuracy==Inf,])
hist(L1HS[L1HS$accuracy==Inf & L1HS$tot_counts>10,]$avg_conf)
nrow(L1HS[L1HS$accuracy==Inf & L1HS$tot_counts>10,])
nrow(L1HS$tot_counts>10)
nrow(L1HS[L1HS$tot_counts>10,])
exp_L1HS<-(L1HS[L1HS$tot_counts>10,])
exp_L1HS
nrow(exp_L1HS[exp_L1HS$accuracy==Inf,])
nrow(exp_L1HS)
nrow(L1HS[L1HS$counts >10 & L1HS$tot_counts==0,])
LUAD_potITLs <- read.delim("E:/Dropbox/Lab/Lab_Documents/TCGA/LUAD_potITLs.txt", header=FALSE, stringsAsFactors=FALSE)
hg19 <- read.delim("E:/Dropbox/Lab/Lab_Documents/TCGA/hg19_all.bed", header=FALSE, stringsAsFactors=FALSE)
head(LUAD_potITLs)
LUAD_potITLs$Class<-ifelse(grepl("SINE",LUAD_potITLs$V4),"SINE",
ifelse(grepl("LINE",LUAD_potITLs$V4),"LINE",
ifelse(grepl("LTR",LUAD_potITLs$V4),"LTR",
ifelse(grepl("DNA",LUAD_potITLs$V4),"DNA", "other"))))
Sample<-strsplit(LUAD_potITLs$V7,"_")
LUAD_potITLs$TCGA <- sapply(Sample,"[[",1)
LUAD_potITLs$type <-ifelse(grepl("t",LUAD_potITLs$V7),"tumor","normal")
head(LUAD_potITLs)
ITLTypecount<-count(LUAD_potITLs,vars="type")
head(ITLTypecount)
ITLTypecount<-count(LUAD_potITLs,vars=c("TCGA","type")
)0
ITLTypecount<-count(LUAD_potITLs,vars=c("TCGA","type"))
head(ITLTypecount)
t.test(ITLTypecount[ITLTypecount$type=="normal","freq"],ITLTypecount[ITLTypecount$type=="tumor","freq"])
intergenic_100k_0flank_100_sample_01_1_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts.txt", stringsAsFactors=FALSE)
View(intergenic_100k_0flank_100_sample_01_1_counts)
intergenic_100k_0flank_100_sample_01_0_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_0_counts.txt", stringsAsFactors=FALSE)
intergenic_100k_0flank_100_sample_01_1_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts.txt", stringsAsFactors=FALSE)
intergenic_100k_0flank_100_sample_01_2_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_2_counts.txt", stringsAsFactors=FALSE)
intergenic_100k_0flank_100_sample_01_5_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_5_counts.txt", stringsAsFactors=FALSE)
intergenic_100k_0flank_100_sample_01_10_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_10_counts.txt", stringsAsFactors=FALSE)
intergenic_100k_0flank_100_sample_01_15_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_15_counts.txt", stringsAsFactors=FALSE)
intergenic_100k_0flank_100_sample_01_20_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_20_counts.txt", stringsAsFactors=FALSE)
intergenic_100k_0flank_100_sample_01_25_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_25_counts.txt", stringsAsFactors=FALSE)
intergenic_100k_0flank_100_sample_01_50_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_50_counts.txt", stringsAsFactors=FALSE)
test_0_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts_0.txt", stringsAsFactors=FALSE)
test_1_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts_1.txt", stringsAsFactors=FALSE)
test_2_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts_2.txt", stringsAsFactors=FALSE)
test_5_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts_5.txt", stringsAsFactors=FALSE)
test_10_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts_10.txt", stringsAsFactors=FALSE)
test_15_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts_15.txt", stringsAsFactors=FALSE)
test_20_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts_20.txt", stringsAsFactors=FALSE)
test_25_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts_25.txt", stringsAsFactors=FALSE)
test_50_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts_50.txt", stringsAsFactors=FALSE)
test_0_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts.txt", stringsAsFactors=FALSE)
combined <- rbind(test_0_counts,test_1_counts,test_2_counts)
combined <- rbind(test_0_counts,test_1_counts,test_2_counts, test_5_counts,test_10_counts,test_15_counts,test_20_counts,test_25_countstest_50_counts)
combined <- rbind(test_0_counts,test_1_counts,test_2_counts, test_5_counts,test_10_counts,test_20_counts,test_25_countstest_50_counts)
combined <- rbind(test_0_counts,test_1_counts,test_2_counts, test_5_counts,test_10_counts,test_20_counts,test_25_counts,test_50_counts)
Sim <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/intergenic_100k_0flank_100_sample_01_1_TEcount.txt", header=FALSE, stringsAsFactors=FALSE)
combined$coord<-get_coord(combined$TE_ID)
colnames(Sim ) <-c("TE_ID_old","counts")
Sim$coord<-get_coord(Sim$TE_ID_old)
combined_sim<-merge(combined,Sim,by="coord",all=TRUE)
combined_sim[is.na(combined_sim)]<-0
test_0_counts$i <-0
test_1_counts$i <-1
test_5_counts$i <-5
test_10_counts$i <-10
test_20_counts$i <-20
test_25_counts$i <-25
test_50_counts$i <-50
combined <- rbind(test_0_counts,test_1_counts,test_2_counts, test_5_counts,test_10_counts,test_20_counts,test_25_counts,test_50_counts)
test_15_counts$i <-15
test_2_counts$i <-2
combined <- rbind(test_0_counts,test_1_counts,test_2_counts, test_5_counts,test_10_counts,test_20_counts,test_25_counts,test_50_counts)
combined$coord<-get_coord(combined$TE_ID)
Sim$coord<-get_coord(Sim$TE_ID_old)
combined_sim<-merge(combined,Sim,by="coord",all=TRUE)
combined_sim[is.na(combined_sim)]<-0
combined_sim$accuracy <-combined_sim$tot_counts/combined_sim$counts*100
ggplot(combined_sim,aes(x=i,y=accuracy)) + geom_line()
ifelse(combined_sim$counts > 10 & combined_sim$tot_counts ==0,"FN",
ifelse(combined_sim$counts ==0 & combined_sim$tot_counts > 10,"FP",
combined_sim$counts==0 & combined_sim$tot_counts ==0, "TN","other")
ggplot(combined_sim,aes(x=i,y=accuracy)) + geom_line()
combined_sim$TP<-ifelse(combined_sim$counts > 10 & combined_sim$tot_counts > 10, "TP",
)
combined_sim$TP<-ifelse(combined_sim$counts > 10 & combined_sim$tot_counts > 10, "TP",
ifelse(combined_sim$counts > 10 & combined_sim$tot_counts ==0,"FN",
ifelse(combined_sim$counts ==0 & combined_sim$tot_counts > 10,"FP",
combined_sim$counts==0 & combined_sim$tot_counts ==0, "TN","other")))
combined_sim$TP<-ifelse(combined_sim$counts > 10 & combined_sim$tot_counts > 10, "TP",
ifelse(combined_sim$counts > 10 & combined_sim$tot_counts ==0,"FN",
ifelse(combined_sim$counts ==0 & combined_sim$tot_counts > 10,"FP",
ifelse(combined_sim$counts==0 & combined_sim$tot_counts ==0, "TN","other"))))
TP_count<-count(combined_sim,var=c("i","TP"))
TP_count
combined_sim[is.na(combined_sim)]<-0
combined_sim$TP<-ifelse(combined_sim$counts > 10 & combined_sim$tot_counts > 10, "TP",
ifelse(combined_sim$counts > 10 & combined_sim$tot_counts ==0,"FN",
ifelse(combined_sim$counts ==0 & combined_sim$tot_counts > 10,"FP",
ifelse(combined_sim$counts==0 & combined_sim$tot_counts ==0, "TN","other"))))
TP_count<-count(combined_sim,var=c("i","TP"))
TP_count
nrow(combined_sim[combined_sim$counts==0 & combined_sim$tot_counts ==0,])
head(combined_sim)
combined_sim$TP<-ifelse(combined_sim$counts > 10 & combined_sim$tot_counts > 10, "TP",
ifelse(combined_sim$counts > 10 & combined_sim$tot_counts <1,"FN",
ifelse(combined_sim$counts ==0 & combined_sim$tot_counts > 10,"FP",
ifelse(combined_sim$counts==0 & combined_sim$tot_counts <1, "TN","other"))))
TP_count<-count(combined_sim,var=c("i","TP"))
TP_count
combined_sim$result<-ifelse(combined_sim$tot_counts > 10, "P",
ifelse( combined_sim$tot_counts <1,"N",
ifelse( combined_sim$tot_counts > 10,"P",
ifelse(combined_sim$tot_counts <1, "N","other"))))
result_count<-count(combined_sim,var=c("i","result"))
result_count
colnames(result_count)<-c("i","resul","total")
TP_result<-merge(TP_count,result_count,by="i")
head(TP_result)
colnames(result_count)<-c("i","result","total")
TP_result<-merge(TP_count,result_count,by="i")
TP_result$percent<-TP_result$freq/total
TP_result$percent<-TP_result$freq/TP_result$total
head(TP_result)
sensitivity <- TP_result[TP_result$TP=="TP" & TP_result$result=="P",]
sensitivity <- TP_result[TP_result$TP=="TP" & TP_result$result=="P",]
specificity<-TP_result[TP_result$TP=="FN" & TP_result$result=="N",]
head(sensitivity)
sensitivity$sensitivity<-sensitivity$percent
specificity$specificty<-1-specificity$percent
ROC<-merge(sensitivity[,c(1,7)],specificty[,c(1,7)],by="i")
ROC<-merge(sensitivity[,c(1,7)],specificity[,c(1,7)],by="i")
ROC
combined_sim_young<-combined_sim[grepl(c("AluYa5"|"AluYb8"|"AluYb9"|"AluY"|"L1HS"),combined_sim$TE_ID),]
combined_sim_young<-combined_sim[grepl(c("AluYa5|AluYb8|AluYb9|AluY|L1HS"),combined_sim$TE_ID),]
combined_sim_young$TP<-ifelse(combined_sim_young$counts > 10 & combined_sim_young$tot_counts > 10, "TP",
ifelse(combined_sim_young$counts > 10 & combined_sim_young$tot_counts <1,"FN",
ifelse(combined_sim_young$counts ==0 & combined_sim_young$tot_counts > 10,"FP",
ifelse(combined_sim_young$counts==0 & combined_sim_young$tot_counts <1, "TN","other"))))
combined_sim_young$result<-ifelse(combined_sim_young$tot_counts > 10, "P",
ifelse( combined_sim_young$tot_counts <1,"N",
ifelse( combined_sim_young$tot_counts > 10,"P",
ifelse(combined_sim_young$tot_counts <1, "N","other"))))
TP_count<-count(combined_sim_young,var=c("i","TP"))
result_count<-count(combined_sim_young,var=c("i","result"))
colnames(result_count)<-c("i","result","total")
TP_result<-merge(TP_count,result_count,by="i")
TP_result$percent<-TP_result$freq/TP_result$total
sensitivity <- TP_result[TP_result$TP=="TP" & TP_result$result=="P",]
sensitivity$sensitivity<-sensitivity$percent
specificity<-TP_result[TP_result$TP=="FN" & TP_result$result=="N",]
specificity$specificty<-1-specificity$percent
ROC<-merge(sensitivity[,c(1,7)],specificity[,c(1,7)],by="i")
ROC
combined_sim_young<-combined_sim[grepl(c("AluYa5|AluYb8|AluYb9|L1HS"),combined_sim$TE_ID),]
combined_sim_young$TP<-ifelse(combined_sim_young$counts > 10 & combined_sim_young$tot_counts > 10, "TP",
ifelse(combined_sim_young$counts > 10 & combined_sim_young$tot_counts <1,"FN",
ifelse(combined_sim_young$counts ==0 & combined_sim_young$tot_counts > 10,"FP",
ifelse(combined_sim_young$counts==0 & combined_sim_young$tot_counts <1, "TN","other"))))
combined_sim_young$result<-ifelse(combined_sim_young$tot_counts > 10, "P",
ifelse( combined_sim_young$tot_counts <1,"N",
ifelse( combined_sim_young$tot_counts > 10,"P",
ifelse(combined_sim_young$tot_counts <1, "N","other"))))
TP_count<-count(combined_sim_young,var=c("i","TP"))
result_count<-count(combined_sim_young,var=c("i","result"))
colnames(result_count)<-c("i","result","total")
TP_result<-merge(TP_count,result_count,by="i")
TP_result$percent<-TP_result$freq/TP_result$total
sensitivity <- TP_result[TP_result$TP=="TP" & TP_result$result=="P",]
sensitivity$sensitivity<-sensitivity$percent
specificity<-TP_result[TP_result$TP=="FN" & TP_result$result=="N",]
specificity$specificty<-1-specificity$percent
ROC<-merge(sensitivity[,c(1,7)],specificity[,c(1,7)],by="i")
ROC
ggplot(combined_sim_young,aes(x=sensitivity,y=specificity,group=i)) + geom_line()
ggplot(ROC,aes(x=sensitivity,y=specificity,group=i)) + geom_line()
ggplot(ROC,aes(x=sensitivity,y=specificity,colour=i)) + geom_line()
ggplot(ROC,aes(x=sensitivity,y=specificity,colour=i)) + geom_point()
ROC
combined_sim_young$accuracy<-combined_sim_young$tot_counts/combined_sim_young$counts
accuracy<-aggregate(accuracy~i,data=combined_sim_young,FUN="mean")
accuracy
accuracy<-aggregate(accuracy~i,data=combined_sim_young[combined_sim_young$counts>10,],FUN="mean")
accuracy
sum(test_1_counts$tot_counts)
TCGA.44.2668_LUAD_n_48_r1_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/TCGA-44-2668_LUAD_n_48_r1_counts.txt", stringsAsFactors=FALSE)
View(TCGA.44.2668_LUAD_n_48_r1_counts)
sum(TCGA.44.2668_LUAD_n_48_r1_counts$tot_counts)
TCGA.44.2668_LUAD_n_48_r1_counts_young<-TCGA.44.2668_LUAD_n_48_r1_count[grepl(c("AluYa5|AluYb8|AluYb9|L1HS"),TCGA.44.2668_LUAD_n_48_r1_count$TE_ID),]
TCGA.44.2668_LUAD_n_48_r1_counts_young<-TCGA.44.2668_LUAD_n_48_r1_counts[grepl(c("AluYa5|AluYb8|AluYb9|L1HS"),TCGA.44.2668_LUAD_n_48_r1_counts$TE_ID),]
sum(TCGA.44.2668_LUAD_n_48_r1_counts_young$tot_count)
sum(combined_sim_young$tot_count)
TCGA.44.2668_LUAD_n_48_r1_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/TCGA-44-2668_LUAD_n_48_r1_counts.txt", stringsAsFactors=FALSE)
TCGA.44.2668_LUAD_n_48_r1_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/TCGA-44-2668_LUAD_n_48_r1_counts.txt", stringsAsFactors=FALSE)
TCGA-44-2668_LUAD_t_48_squire_counts<- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/TCGA-44-2668_LUAD_n_48_r1_counts.txt", stringsAsFactors=FALSE)
TCGA-44-2668_LUAD_t_48_squire_counts<- read.delim("TCGA-44-2668_LUAD_t_48_squire_counts", stringsAsFactors=FALSE)
TCGA-44-2668_LUAD_t_48_squire_counts<- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/TCGA-44-2668_LUAD_t_48_squire_counts", stringsAsFactors=FALSE)
TCGA.44.2668_LUAD_t_48_squire_counts<- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/TCGA-44-2668_LUAD_t_48_squire_counts", stringsAsFactors=FALSE)
TCGA.44.2668_LUAD_t_48_squire_counts<- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/TCGA-44-2668_LUAD_t_48_squire_counts.txt", stringsAsFactors=FALSE)
TCGA.44.2668_LUAD_t_48_squire_countss_young<-TCGA.44.2668_LUAD_t_48_squire_countss[grepl(c("AluYa5|AluYb8|AluYb9|L1HS"),TCGA.44.2668_LUAD_t_48_squire_countss$TE_ID),]
sum(TCGA.44.2668_LUAD_t_48_squire_counts_young$tot_count)
sum(TCGA.44.2668_LUAD_t_48_squire_countss_young$tot_count)
TCGA.44.2668_LUAD_t_48_squire_countss_young<-TCGA.44.2668_LUAD_t_48_squire_countss[grepl(c("AluYa5|AluYb8|AluYb9|L1HS"),TCGA.44.2668_LUAD_t_48_squire_countss$TE_ID),]
TCGA.44.2668_LUAD_t_48_squire_counts_young<-TCGA.44.2668_LUAD_t_48_squire_counts[grepl(c("AluYa5|AluYb8|AluYb9|L1HS"),TCGA.44.2668_LUAD_t_48_squire_counts$TE_ID),]
sum(TCGA.44.2668_LUAD_t_48_squire_counts_young$tot_count)
head(TCGA.44.2668_LUAD_t_48_squire_counts)
head(TCGA.44.2668_LUAD_t_48_squire_counts_young)
sum(TCGA.44.2668_LUAD_t_48_squire_counts_young$TE.tot.plus)
sum(TCGA.44.2668_LUAD_n_48_r1_counts_young$tot_count)
TCGA.44.2668_LUAD_n_48_r1_counts_50 <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/TCGA-44-2668_LUAD_n_48_r1_counts_50.txt", stringsAsFactors=FALSE)
View(TCGA.44.2668_LUAD_n_48_r1_counts_50)
TCGA.44.2668_LUAD_n_48_r1_counts_50_young<-TCGA.44.2668_LUAD_n_48_r1_counts_50[grepl(c("AluYa5|AluYb8|AluYb9|L1HS"),TCGA.44.2668_LUAD_n_48_r1_counts_50$TE_ID),]
sum(TCGA.44.2668_LUAD_n_48_r1_counts_50_young$tot_count)
TCGA.44.2668_LUAD_n_48_r1_counts_7 <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/TCGA-44-2668_LUAD_n_48_r1_counts_7.txt", stringsAsFactors=FALSE)
TCGA.44.2668_LUAD_n_48_r1_counts_7_young<-TCGA.44.2668_LUAD_n_48_r1_counts_7[grepl(c("AluYa5|AluYb8|AluYb9|L1HS"),TCGA.44.2668_LUAD_n_48_r1_counts_7$TE_ID),]
sum(TCGA.44.2668_LUAD_n_48_r1_counts_7_young$tot_count)
squire_flag_TE_abund_dis_joined_1k_10k <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/squire_flag_TE_abund_dis_joined_1k_10k.tmpW2MCh3_sorted", header=FALSE, stringsAsFactors=FALSE)
View(squire_flag_TE_abund_dis_joined_1k_10k)
TCGA.44.2668_LUAD_n_48_r1_counts_19 <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/TCGA-44-2668_LUAD_n_48_r1_counts_19.txt", stringsAsFactors=FALSE)
TCGA.44.2668_LUAD_n_48_r1_counts_19_young<-TCGA.44.2668_LUAD_n_48_r1_counts_19[grepl(c("AluYa5|AluYb8|AluYb9|L1HS"),TCGA.44.2668_LUAD_n_48_r1_counts_19$TE_ID),]
sum(TCGA.44.2668_LUAD_n_48_r1_counts_19_young$tot_count)
test_19_counts <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/intergenic_100k_0flank_100_sample_01_1_counts_19.txt", stringsAsFactors=FALSE)
combined <- rbind(test_0_counts,test_1_counts,test_2_counts, test_5_counts,test_10_counts,test_19_counts,test_20_counts,test_25_counts,test_50_counts)
test_19_counts$i <-19
combined <- rbind(test_0_counts,test_1_counts,test_2_counts, test_5_counts,test_10_counts,test_19_counts,test_20_counts,test_25_counts,test_50_counts)
colnames(test_19_counts)<-colnames(test_20_counts)
combined <- rbind(test_0_counts,test_1_counts,test_2_counts, test_5_counts,test_10_counts,test_19_counts,test_20_counts,test_25_counts,test_50_counts)
head(test_19_coutns)
head(test_19_counts)
colnames(test_19_counts)<-colnames(test_20_counts)
combined <- rbind(test_0_counts,test_1_counts,test_2_counts, test_5_counts,test_10_counts,test_19_counts,test_20_counts,test_25_counts,test_50_counts)
head(test_19_counts)
squire_flag_TE_abund_dis_joined_1k_10k <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/squire_flag_TE_abund_dis_joined_1k_10k.tmp7eutM3_sorted", header=FALSE, stringsAsFactors=FALSE)
View(squire_flag_TE_abund_dis_joined_1k_10k)
readthrough <- squire_flag_TE_abund_dis_joined_1k_10k[(squire_flag_TE_abund_dis_joined_1k_10k$V59 < squire_flag_TE_abund_dis_joined_1k_10k$V29 | squire_flag_TE_abund_dis_joined_1k_10k$60>squire_flag_TE_abund_dis_joined_1k_10k$30) & squire_flag_TE_abund_dis_joined_1k_10k$40 !=0,]
readthrough <- squire_flag_TE_abund_dis_joined_1k_10k[(squire_flag_TE_abund_dis_joined_1k_10k$V59 < squire_flag_TE_abund_dis_joined_1k_10k$V29 | squire_flag_TE_abund_dis_joined_1k_10k$V60>squire_flag_TE_abund_dis_joined_1k_10k$V30) & squire_flag_TE_abund_dis_joined_1k_10k$40 !=0,]
readthrough <- squire_flag_TE_abund_dis_joined_1k_10k[(squire_flag_TE_abund_dis_joined_1k_10k$V59 < squire_flag_TE_abund_dis_joined_1k_10k$V29 | squire_flag_TE_abund_dis_joined_1k_10k$V60>squire_flag_TE_abund_dis_joined_1k_10k$V30) & squire_flag_TE_abund_dis_joined_1k_10k$F40 !=0,]
readthrough <- squire_flag_TE_abund_dis_joined_1k_10k[(squire_flag_TE_abund_dis_joined_1k_10k$V59 < squire_flag_TE_abund_dis_joined_1k_10k$V29 | squire_flag_TE_abund_dis_joined_1k_10k$V60>squire_flag_TE_abund_dis_joined_1k_10k$V30) & squire_flag_TE_abund_dis_joined_1k_10k$V40 !=0,]
head(readthrough)
readthrough <- squire_flag_TE_abund_dis_joined_1k_10k[((squire_flag_TE_abund_dis_joined_1k_10k$V59 < squire_flag_TE_abund_dis_joined_1k_10k$V29 & squire_flag_TE_abund_dis_joined_1k_10k$V60 <=squire_flag_TE_abund_dis_joined_1k_10k$V30 )| (squire_flag_TE_abund_dis_joined_1k_10k$V60>squire_flag_TE_abund_dis_joined_1k_10k$V30 & squire_flag_TE_abund_dis_joined_1k_10k$V59 >= squire_flag_TE_abund_dis_joined_1k_10k$V29)) & squire_flag_TE_abund_dis_joined_1k_10k$V40 !=0,]
head(readthrough)
readthrough <- squire_flag_TE_abund_dis_joined_1k_10k[((squire_flag_TE_abund_dis_joined_1k_10k$V59 < squire_flag_TE_abund_dis_joined_1k_10k$V29 & squire_flag_TE_abund_dis_joined_1k_10k$V60 <=squire_flag_TE_abund_dis_joined_1k_10k$V30 & squire_flag_TE_abund_dis_joined_1k_10k$V60 >= squire_flag_TE_abund_dis_joined_1k_10k$V29)| (squire_flag_TE_abund_dis_joined_1k_10k$V60>squire_flag_TE_abund_dis_joined_1k_10k$V30 & squire_flag_TE_abund_dis_joined_1k_10k$V59 >= squire_flag_TE_abund_dis_joined_1k_10k$V29 & squire_flag_TE_abund_dis_joined_1k_10k$V59 <= squire_flag_TE_abund_dis_joined_1k_10k$V30)) & squire_flag_TE_abund_dis_joined_1k_10k$V40 !=0,]
head(readthrough)
range(squire_flag_TE_abund_dis_joined_1k_10k$V23)
accuracy<-aggregate(tot_count~i,data=combined_sim_young[combined_sim_young$counts>10,],FUN="sum")
head(combined_sim_young)
tot_count<-aggregatetot_counts~i,data=combined_sim_young[combined_sim_young$counts>10,],FUN="sum")
tot_count<-aggregate(tot_counts~i,data=combined_sim_young[combined_sim_young$counts>10,],FUN="sum")
tot_count
squire_flag_TE_abund_dis_joined_1k_10k <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/squire_flag_TE_abund_dis_joined_1k_10k.tmpgxCHq6_sorted", header=FALSE, stringsAsFactors=FALSE)
View(squire_flag_TE_abund_dis_joined_1k_10k)
squire_flag_TE_abund_dis_joined_1k_10k <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/squire_flag_TE_abund_dis_joined_1k_10k.tmpJop1sT_sorted", header=FALSE, stringsAsFactors=FALSE)
View(squire_flag_TE_abund_dis_joined_1k_10k)
colnames(squire_flag_input) <-c("tx_chr","tx_start","tx_stop","TE_ID","tx_fpkm","tx_strand","sample","aligned_size","TE_chr","TE_start","TE_stop","TE_taxo","milliDiv","TE_strand","unique_count","total_count","total_reads","conf","down_gene_chr","down_gene_start","down_gene_stop","down_gene_ID","down_gene_strand","down_gene_CDS_start","down_gene_CDS_stop","down_gene_exon_count","down_gene_exon_sizes","down_gene_exon_starts","down_gene_distance","up_gene_chr","up_gene_start","up_gene_stop","up_gene_ID","up_gene_strand","up_gene_CDS_start","up_gene_CDS_stop","up_gene_exon_count","up_gene_exon_sizes","up_gene_exon_starts","up_gene_distance","stringtie_chr","stringtie_start","stringtie_stop","merged1k_chr","merged1k_start","merged1k_stop","merged10k_chr","merged10k_start","merged10k_stop")
squire_flag_input <- read.delim("E:/Dropbox/Lab/Lab_Documents/RepTag_counts/Bioinformatics_paper/EM_test/squire_flag_TE_abund_dis_joined_1k_10k.tmpJop1sT_sorted", header=FALSE, stringsAsFactors=FALSE)
colnames(squire_flag_input) <-c("tx_chr","tx_start","tx_stop","TE_ID","tx_fpkm","tx_strand","sample","aligned_size","TE_chr","TE_start","TE_stop","TE_taxo","milliDiv","TE_strand","unique_count","total_count","total_reads","conf","down_gene_chr","down_gene_start","down_gene_stop","down_gene_ID","down_gene_strand","down_gene_CDS_start","down_gene_CDS_stop","down_gene_exon_count","down_gene_exon_sizes","down_gene_exon_starts","down_gene_distance","up_gene_chr","up_gene_start","up_gene_stop","up_gene_ID","up_gene_strand","up_gene_CDS_start","up_gene_CDS_stop","up_gene_exon_count","up_gene_exon_sizes","up_gene_exon_starts","up_gene_distance","stringtie_chr","stringtie_start","stringtie_stop","merged1k_chr","merged1k_start","merged1k_stop","merged10k_chr","merged10k_start","merged10k_stop")
head(squire_flag_input)
colnames(squire_flag_input) <-c("tx_chr","tx_start","tx_stop","TE_ID","tx_fpkm","tx_strand","sample","aligned_size","TE_chr","TE_start","TE_stop","TE_taxo","milliDiv","TE_strand","unique_count","total_count","total_reads","conf","down_gene_chr","down_gene_start","down_gene_stop","down_gene_ID","down_gene_score","down_gene_strand","down_gene_CDS_start","down_gene_CDS_stop","down_gene_exon_count","down_gene_exon_sizes","down_gene_exon_starts","down_gene_distance","up_gene_chr","up_gene_start","up_gene_stop","up_gene_ID","up_gene_score","up_gene_strand","up_gene_CDS_start","up_gene_CDS_stop","up_gene_exon_count","up_gene_exon_sizes","up_gene_exon_starts","up_gene_distance","stringtie_chr","stringtie_start","stringtie_stop","merged1k_chr","merged1k_start","merged1k_stop","merged10k_chr","merged10k_start","merged10k_stop")
head(squire_flag_input)
colnames(squire_flag_input) <-c("tx_chr","tx_start","tx_stop","TE_ID","tx_fpkm","tx_strand","sample","aligned_size","TE_chr","TE_start","TE_stop","TE_taxo","milliDiv","TE_strand","unique_count","total_count","total_reads","conf","down_gene_chr","down_gene_start","down_gene_stop","down_gene_ID","down_gene_score","down_gene_strand","down_gene_CDS_start","down_gene_CDS_stop","down_gene_exon_count","down_gene_exon_sizes","down_gene_exon_starts","down_gene_distance","up_gene_chr","up_gene_start","up_gene_stop","up_gene_ID","up_gene_score","up_gene_strand","up_gene_CDS_start","up_gene_CDS_stop","up_gene_exon_count","up_gene_exon_sizes","up_gene_exon_starts","up_gene_distance","stringtie_chr","stringtie_start","stringtie_stop","stringtie_overlap","merged1k_chr","merged1k_start","merged1k_stop","merged1k_overlap","merged10k_chr","merged10k_start","merged10k_stop","merged10k_overlap")
squire_flag_input
head(squire_flag_input)
colnames(squire_flag_input) <-c("tx_chr","tx_start","tx_stop","TE_ID","tx_fpkm","tx_strand","sample","aligned_size","TE_chr","TE_start","TE_stop","TE_taxo","milliDiv","TE_strand","unique_count","total_count","total_reads","conf","down_gene_chr","down_gene_start","down_gene_stop","down_gene_ID","down_gene_score","down_gene_strand","down_gene_CDS_start","down_gene_CDS_stop","down_gene_rgb","down_gene_exon_count","down_gene_exon_sizes","down_gene_exon_starts","down_gene_distance","up_gene_chr","up_gene_start","up_gene_stop","up_gene_ID","up_gene_score","up_gene_strand","up_gene_CDS_start","up_gene_CDS_stop","up_gene_rgb","up_gene_exon_count","up_gene_exon_sizes","up_gene_exon_starts","up_gene_distance","stringtie_chr","stringtie_start","stringtie_stop","stringtie_overlap","merged1k_chr","merged1k_start","merged1k_stop","merged1k_overlap","merged10k_chr","merged10k_start","merged10k_stop","merged10k_overlap")
colnames(squire_flag_input) <-c("tx_chr","tx_start","tx_stop","TE_ID","tx_fpkm","tx_strand","sample","aligned_size","TE_chr","TE_start","TE_stop","TE_taxo","milliDiv","TE_strand","unique_count","total_count","total_reads","conf","down_gene_chr","down_gene_start","down_gene_stop","down_gene_ID","down_gene_score","down_gene_strand","down_gene_CDS_start","down_gene_CDS_stop","down_gene_rgb","down_gene_exon_count","down_gene_exon_sizes","down_gene_exon_starts","down_gene_distance","up_gene_chr","up_gene_start","up_gene_stop","up_gene_ID","up_gene_score","up_gene_strand","up_gene_CDS_start","up_gene_CDS_stop","up_gene_rgb","up_gene_exon_count","up_gene_exon_sizes","up_gene_exon_starts","up_gene_distance","stringtie_chr","stringtie_start","stringtie_stop","merged1k_chr","merged1k_start","merged1k_stop","merged1k_overlap","merged10k_chr","merged10k_start","merged10k_stop","merged10k_overlap")
head(squire_flag_input)
squire_flag_input$position <-ifelse(squire_flag_input$down_gene_distance == 0,"genic",
ifelse(squire_flag_input$up_gene_distance==0,"genic",
ifelse(squire_flag_input$down_gene_distance < 10000,"perigenic",
ifelse(squire_flag_input$up_gene_distance <10000,"perigenic","intergenic"))))
squire_flat_input$downgene_strandedness<-ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$down_gene_strand =="+","sense"
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$down_gene_strand=="-","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$down_gene_strand =="+","antisense"
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$down_gene_strand=="-","antisense",
"NA")))
squire_flat_input$downgene_strandedness<-ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$down_gene_strand =="+","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$down_gene_strand=="-","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$down_gene_strand =="+","antisense"
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$down_gene_strand=="-","antisense",
"NA")))
squire_flat_input$downgene_strandedness<-ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$down_gene_strand =="+","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$down_gene_strand =="+","antisense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$down_gene_strand=="-","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$down_gene_strand=="-","antisense",
"NA")))
)
strandedness=0
squire_flat_input$downgene_strandedness<-ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$down_gene_strand =="+","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$down_gene_strand=="-","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$down_gene_strand =="+","antisense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$down_gene_strand=="-","antisense",
"NA"))))
squire_flag_input$downgene_strandedness<-ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$down_gene_strand =="+","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$down_gene_strand=="-","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$down_gene_strand =="+","antisense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$down_gene_strand=="-","antisense",
"NA"))))
squire_flag_input$upgene_strandedness<-ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$up_gene_strand =="+","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$up_gene_strand=="-","sense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="-" & squire_flag_input$up_gene_strand =="+","antisense",
ifelse(strandedness > 0 & squire_flag_input$tx_strand=="+" & squire_flag_input$up_gene_strand=="-","antisense",
"NA"))))
View(squire_flag_input)
table(squire_flag_input$up_gene_exon_count)
squire_flag_input[squire_flag_input$up_gene_exon_count==".",]
head(squire_flat_input)
head(squire_flag_input)
(squire_flag_input[7:10])
(squire_flag_input[7:10,])
